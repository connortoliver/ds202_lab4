---
title: "Lab #4"
author: "Connor Toliver"
date: "3/11/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


Part 1

```{r}
library(readxl)
library(tidyverse)
defense <- read_excel('cyclonesFootball2019.xlsx', sheet='Defensive')
offense <- read_excel('cyclonesFootball2019.xlsx', sheet='Offensive')
biography <- read_excel('cyclonesFootball2019.xlsx', sheet='Biography')
```

```{r}
defClean <- defense %>% 
  mutate_at(c('Name', 'Opponent_Opponent'), factor)

offClean <- offense %>% 
  mutate_at(c('Name', 'Opponent_Opponent'), factor)

bioClean <- biography %>% 
  mutate_at(c('Name', 'Hometown', 'Highschool', 'Position', 'Class'), factor)
```

```{r}
defClean <- defClean %>% 
  mutate_at(c(3:11), as.numeric)

offClean <- offClean %>% 
  mutate_at(c(3:12), as.numeric)

bioClean <- bioClean %>% 
  mutate(temp1 = as.numeric(substring(Height, 1, 1))) %>% 
  mutate(temp2 = as.numeric(substring(Height, 3))) %>% 
  mutate(Height = (temp1 * 12) + temp2) %>% 
  mutate(temp1 = NULL) %>% 
  mutate(temp2 = NULL)

str(bioClean)
```

```{r}
str(defClean)
```

```{r}
str(offClean)
```

```{r}
str(bioClean)
```

Part 2

```{r}
defClean <- defClean %>% 
  pivot_longer(Tackles_Solo:Pass_PB, names_to = 'Statistic')

ggplot(defClean, aes(x = value)) + geom_histogram() + facet_wrap(~Statistic)
```


```{r}
defClean %>% 
  filter(Opponent_Opponent == 'West Virginia' | Opponent_Opponent == 'Kansas State') %>% 
  filter(Statistic == 'Tackles_Solo') %>% 
  pivot_wider(names_from = 'Opponent_Opponent', values_from = 'value') %>% 
  select(Name, 'West Virginia', 'Kansas State') %>% 
  ggplot(aes(`West Virginia`, `Kansas State`)) + geom_jitter()
```

```{r}
bioClean <- bioClean %>% 
  separate(Hometown, sep=', ', into=c('City', 'State'))

bioClean %>% 
  group_by(State) %>% 
  select(State) %>% 
  summarize(n =n())
```

Part 3
```{r}
combined <- offclean %>% 
  left_join(bioclean, b='Name')
```

```{r}
combined$Name = as.factor(combined$Name)
combined$Receiving_YDS[is.na(combined$Receiving_YDS)] = 0

q2 = combined %>% 
  group_by(combined$Name) %>% 
  summarise(
    totalRecYards = sum(Receiving_YDS),
    Weight = mean(Weight)) %>% 
  drop_na()

q2 %>% 
  ggplot(aes(x = Weight, y = totalRecYards)) + geom_point() +
  xlim(c(0,300)) + xlab("Weight") +ylab("Total Receiving Yards") +
  ggtitle("ISU Football Weights vs Receiving Yards")
  
```
In my opinion, there does not necessarily appear to be much correlation. Although you can see some grouping on the plot, there are not many data points to begin with and quite a few outliers. For example, there are 6 points ranging from 0 to a little over 100 yds at the 200 lb weight, however there is one point around 200 lbs with over 700 yds. However I would say that because of the grouping, one could argue that there is correlation and if there were more points grouped together per outlier, I would agree with them.




